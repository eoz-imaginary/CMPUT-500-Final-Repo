<html><head><link href="details.css" rel="stylesheet" /><script type="text/javascript" src="search-details.js"></script><title>Proverbot Detailed Report for Rsa.v</title></head><body onload="init()"><pre><code class="plaincommand">(* This program is free software; you can redistribute it and/or      *)
(* modify it under the terms of the GNU Lesser General Public License *)
(* as published by the Free Software Foundation; either version 2.1   *)
(* of the License, or (at your option) any later version.             *)
(*                                                                    *)
(* This program is distributed in the hope that it will be useful,    *)
(* but WITHOUT ANY WARRANTY; without even the implied warranty of     *)
(* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the      *)
(* GNU General Public License for more details.                       *)
(*                                                                    *)
(* You should have received a copy of the GNU Lesser General Public   *)
(* License along with this program; if not, write to the Free         *)
(* Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA *)
(* 02110-1301 USA                                                     *)



(****************************************************************
*  Rsa.g                                                      *
****************************************************************)
Require Import Arith.</code><br /><code class="plaincommand">Require Export Fermat.</code><br /><code class="plaincommand">Section RSA.</code><br /><code class="plaincommand">Variable p q : nat.</code><br /><code class="plaincommand">Variable prime_p : prime p.</code><br /><code class="plaincommand">Variable prime_q : prime q.</code><br /><code class="plaincommand">Variable neq_pq : p &lt;&gt; q.</code><br /><code class="plaincommand">Variable e d : nat.</code><br /><code class="plaincommand">Variable pq : nat.</code><br /><code class="plaincommand">Hypothesis pqnot_zero : pq &lt;&gt; 0.</code><br /><code class="plaincommand">Hypothesis pq_div_p : divides (p - 1) pq.</code><br /><code class="plaincommand">Hypothesis pq_div_q : divides (q - 1) pq.</code><br /><code class="plaincommand">Variable ed_inv : congruent pq (e * d) 1.</code><br /><code class="plaincommand">Definition encrypt (w : nat) : nat := power w e.</code><br /><code class="plaincommand">Definition decrypt (w : nat) : nat := power w d.</code><br /><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdgcd_pq_SO&quot;)" onmouseout="unhoverLemma(&quot;RsaZdgcd_pq_SO&quot;)"><code class="buttontext">Lemma gcd_pq_SO : is_gcd p q 1.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;is_gcd p q (S O)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-0" onmouseover="hoverTactic(&quot;1-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;is_gcd p q (S O)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-1" onmouseover="hoverTactic(&quot;1-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;is_gcd p q (S O)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-0" onmouseover="hoverTactic(&quot;1-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;is_gcd p q (S O)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-1" onmouseover="hoverTactic(&quot;1-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply prime_gcd.</code><br /></span><span data-subgoals="((&quot;prime q&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;not (divides q p)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-2" onmouseover="hoverTactic(&quot;1-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides q p)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-3" onmouseover="hoverTactic(&quot;1-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides q p)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-4" onmouseover="hoverTactic(&quot;1-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">red in |- *.</code><br /></span><span data-subgoals="((&quot;forall _ : divides q p, False&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-5" onmouseover="hoverTactic(&quot;1-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-6" onmouseover="hoverTactic(&quot;1-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion prime_p.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-7" onmouseover="hoverTactic(&quot;1-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case neq_pq.</code><br /></span><span data-subgoals="((&quot;eq p q&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-8" onmouseover="hoverTactic(&quot;1-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply H1.</code><br /></span><span data-subgoals="((&quot;divides q p&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;not (eq q (S O))&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-9" onmouseover="hoverTactic(&quot;1-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (eq q (S O))&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-10" onmouseover="hoverTactic(&quot;1-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (eq q (S O))&quot;, (&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-11" onmouseover="hoverTactic(&quot;1-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion prime_q.</code><br /></span><span data-subgoals="((&quot;not (eq q (S O))&quot;, (&quot;H5 : eq a0 q&quot;,&quot;H4 : forall (b : nat) (_ : divides b q) (_ : not (eq b (S O))), eq q b&quot;,&quot;H3 : not (eq q (S O))&quot;,&quot;a0 : nat&quot;,&quot;H2 : eq a p&quot;,&quot;H1 : forall (b : nat) (_ : divides b p) (_ : not (eq b (S O))), eq p b&quot;,&quot;H0 : not (eq p (S O))&quot;,&quot;a : nat&quot;,&quot;H : divides q p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-1-12" onmouseover="hoverTactic(&quot;1-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="()" id="command-1-13" onmouseover="hoverTactic(&quot;1-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdChinese&quot;)" onmouseout="unhoverLemma(&quot;RsaZdChinese&quot;)"><code class="buttontext">Lemma Chinese :
 forall a b : nat,
 b &lt;= a -&gt; congruent p a b -&gt; congruent q a b -&gt; congruent (p * q) a b.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;forall (a b : nat) (_ : le b a) (_ : congruent p a b)
  (_ : congruent q a b), congruent (Init.Nat.mul p q) a b&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-0" onmouseover="hoverTactic(&quot;3-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall (a b : nat) (_ : le b a) (_ : congruent p a b)
  (_ : congruent q a b), congruent (Init.Nat.mul p q) a b&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-1" onmouseover="hoverTactic(&quot;3-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;forall (a b : nat) (_ : le b a) (_ : congruent p a b)
  (_ : congruent q a b), congruent (Init.Nat.mul p q) a b&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-0" onmouseover="hoverTactic(&quot;3-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall (a b : nat) (_ : le b a) (_ : congruent p a b)
  (_ : congruent q a b), congruent (Init.Nat.mul p q) a b&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-1" onmouseover="hoverTactic(&quot;3-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros a b H' H'0 H'1.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-2" onmouseover="hoverTactic(&quot;3-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (divides p (a - b)).</code><br /></span><span data-subgoals="((&quot;forall _ : divides p (Init.Nat.sub a b),
congruent (Init.Nat.mul p q) a b&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-3" onmouseover="hoverTactic(&quot;3-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'2.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H'2 : divides p (Init.Nat.sub a b)&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-4" onmouseover="hoverTactic(&quot;3-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear H'2.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-5" onmouseover="hoverTactic(&quot;3-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (divides q (a - b)).</code><br /></span><span data-subgoals="((&quot;forall _ : divides q (Init.Nat.sub a b),
congruent (Init.Nat.mul p q) a b&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-6" onmouseover="hoverTactic(&quot;3-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'3.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H'3 : divides q (Init.Nat.sub a b)&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-7" onmouseover="hoverTactic(&quot;3-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear H'3.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-8" onmouseover="hoverTactic(&quot;3-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (divides p q1).</code><br /></span><span data-subgoals="((&quot;forall _ : divides p q1, congruent (Init.Nat.mul p q) a b&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-9" onmouseover="hoverTactic(&quot;3-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'4.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H'4 : divides p q1&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-10" onmouseover="hoverTactic(&quot;3-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear H'4.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) a b&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-11" onmouseover="hoverTactic(&quot;3-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply congruentDef with (u := 0) (v := q2).</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add a (Init.Nat.mul O (Init.Nat.mul p q)))
  (Init.Nat.add b (Init.Nat.mul q2 (Init.Nat.mul p q)))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-12" onmouseover="hoverTactic(&quot;3-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add a O)
  (Init.Nat.add b (Init.Nat.mul q2 (Init.Nat.mul p q)))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-13" onmouseover="hoverTactic(&quot;3-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite mult_assoc.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add a O) (Init.Nat.add b (Nat.mul (Nat.mul q2 p) q))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-14" onmouseover="hoverTactic(&quot;3-14&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- H1.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add a O) (Init.Nat.add b (Nat.mul q1 q))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-15" onmouseover="hoverTactic(&quot;3-15&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- H0.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add a O) (Init.Nat.add b (Init.Nat.sub a b))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-16" onmouseover="hoverTactic(&quot;3-16&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- plus_n_O.</code><br /></span><span data-subgoals="((&quot;eq a (Init.Nat.add b (Init.Nat.sub a b))&quot;, (&quot;H1 : eq q1 (Init.Nat.mul q2 p)&quot;,&quot;q2 : nat&quot;,&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-17" onmouseover="hoverTactic(&quot;3-17&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;divides p q1&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-18" onmouseover="hoverTactic(&quot;3-18&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;divides p q1&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-19" onmouseover="hoverTactic(&quot;3-19&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply L_Euclides with q.</code><br /></span><span data-subgoals="((&quot;is_gcd p q (S O)&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-20" onmouseover="hoverTactic(&quot;3-20&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply gcd_pq_SO.</code><br /></span><span data-subgoals="((&quot;divides p (Init.Nat.mul q q1)&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-21" onmouseover="hoverTactic(&quot;3-21&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply dividesDef with (q := q0).</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul q q1) (Init.Nat.mul q0 p)&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-22" onmouseover="hoverTactic(&quot;3-22&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite (mult_comm q).</code><br /></span><span data-subgoals="((&quot;eq (Nat.mul q1 q) (Init.Nat.mul q0 p)&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-23" onmouseover="hoverTactic(&quot;3-23&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- H.</code><br /></span><span data-subgoals="((&quot;eq (Nat.mul q1 q) (Init.Nat.sub a b)&quot;, (&quot;H0 : eq (Init.Nat.sub a b) (Init.Nat.mul q1 q)&quot;,&quot;q1 : nat&quot;,&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-24" onmouseover="hoverTactic(&quot;3-24&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-25" onmouseover="hoverTactic(&quot;3-25&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;divides q (Init.Nat.sub a b)&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-26" onmouseover="hoverTactic(&quot;3-26&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_divides.</code><br /></span><span data-subgoals="((&quot;le b a&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-27" onmouseover="hoverTactic(&quot;3-27&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q a b&quot;, (&quot;H : eq (Init.Nat.sub a b) (Init.Nat.mul q0 p)&quot;,&quot;q0 : nat&quot;,&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-28" onmouseover="hoverTactic(&quot;3-28&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-29" onmouseover="hoverTactic(&quot;3-29&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;divides p (Init.Nat.sub a b)&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-30" onmouseover="hoverTactic(&quot;3-30&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_divides.</code><br /></span><span data-subgoals="((&quot;le b a&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p a b&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-31" onmouseover="hoverTactic(&quot;3-31&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p a b&quot;, (&quot;H'1 : congruent q a b&quot;,&quot;H'0 : congruent p a b&quot;,&quot;H' : le b a&quot;,&quot;a,b : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-3-32" onmouseover="hoverTactic(&quot;3-32&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="()" id="command-3-33" onmouseover="hoverTactic(&quot;3-33&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdprime_2_or_more&quot;)" onmouseout="unhoverLemma(&quot;RsaZdprime_2_or_more&quot;)"><code class="buttontext">Lemma prime_2_or_more : forall r : nat, prime r -&gt; r = 2 \/ 2 &lt; r.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;forall (r : nat) (_ : prime r), or (eq r (S (S O))) (lt (S (S O)) r)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-0" onmouseover="hoverTactic(&quot;5-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall (r : nat) (_ : prime r), or (eq r (S (S O))) (lt (S (S O)) r)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-1" onmouseover="hoverTactic(&quot;5-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;forall (r : nat) (_ : prime r), or (eq r (S (S O))) (lt (S (S O)) r)&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-0" onmouseover="hoverTactic(&quot;5-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros r.</code><br /></span><span data-subgoals="((&quot;forall _ : prime r, or (eq r (S (S O))) (lt (S (S O)) r)&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-1" onmouseover="hoverTactic(&quot;5-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case r.</code><br /></span><span data-subgoals="((&quot;forall _ : prime O, or (eq O (S (S O))) (lt (S (S O)) O)&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S n)),
or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-2" onmouseover="hoverTactic(&quot;5-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'.</code><br /></span><span data-subgoals="((&quot;or (eq O (S (S O))) (lt (S (S O)) O)&quot;, (&quot;H' : prime O&quot;,&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S n)),
or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-3" onmouseover="hoverTactic(&quot;5-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">absurd (prime 0).</code><br /></span><span data-subgoals="((&quot;not (prime O)&quot;, (&quot;H' : prime O&quot;,&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S n)),
or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-4" onmouseover="hoverTactic(&quot;5-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;prime O&quot;, (&quot;H' : prime O&quot;,&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S n)),
or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-5" onmouseover="hoverTactic(&quot;5-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : prime (S n)),
or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-6" onmouseover="hoverTactic(&quot;5-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n.</code><br /></span><span data-subgoals="((&quot;forall _ : prime (S n), or (eq (S n) (S (S O))) (lt (S (S O)) (S n))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-7" onmouseover="hoverTactic(&quot;5-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case n.</code><br /></span><span data-subgoals="((&quot;forall _ : prime (S O), or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S (S n))),
or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n)))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-8" onmouseover="hoverTactic(&quot;5-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'.</code><br /></span><span data-subgoals="((&quot;or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;, (&quot;H' : prime (S O)&quot;,&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S (S n))),
or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n)))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-9" onmouseover="hoverTactic(&quot;5-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">absurd (prime 1).</code><br /></span><span data-subgoals="((&quot;not (prime (S O))&quot;, (&quot;H' : prime (S O)&quot;,&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S (S n))),
or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n)))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-10" onmouseover="hoverTactic(&quot;5-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;prime (S O)&quot;, (&quot;H' : prime (S O)&quot;,&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S (S n))),
or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n)))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-11" onmouseover="hoverTactic(&quot;5-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : prime (S (S n))),
or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n)))&quot;, (&quot;r,n : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-12" onmouseover="hoverTactic(&quot;5-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n0.</code><br /></span><span data-subgoals="((&quot;forall _ : prime (S (S n0)),
or (eq (S (S n0)) (S (S O))) (lt (S (S O)) (S (S n0)))&quot;, (&quot;r,n,n0 : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-13" onmouseover="hoverTactic(&quot;5-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case n0.</code><br /></span><span data-subgoals="((&quot;forall _ : prime (S (S O)),
or (eq (S (S O)) (S (S O))) (lt (S (S O)) (S (S O)))&quot;, (&quot;r,n,n0 : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : prime (S (S (S n)))),
or (eq (S (S (S n))) (S (S O))) (lt (S (S O)) (S (S (S n))))&quot;, (&quot;r,n,n0 : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-14" onmouseover="hoverTactic(&quot;5-14&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : prime (S (S (S n)))),
or (eq (S (S (S n))) (S (S O))) (lt (S (S O)) (S (S (S n))))&quot;, (&quot;r,n,n0 : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-5-15" onmouseover="hoverTactic(&quot;5-15&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="()" id="command-5-16" onmouseover="hoverTactic(&quot;5-16&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdphi_gt_SO&quot;)" onmouseout="unhoverLemma(&quot;RsaZdphi_gt_SO&quot;)"><code class="buttontext">Lemma phi_gt_SO : 1 &lt; pq.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-0" onmouseover="hoverTactic(&quot;7-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-1" onmouseover="hoverTactic(&quot;7-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-0" onmouseover="hoverTactic(&quot;7-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-1" onmouseover="hoverTactic(&quot;7-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim (prime_2_or_more p).</code><br /></span><span data-subgoals="((&quot;forall _ : eq p (S (S O)), lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-2" onmouseover="hoverTactic(&quot;7-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq p (S (S O)), lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-3" onmouseover="hoverTactic(&quot;7-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-4" onmouseover="hoverTactic(&quot;7-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim (prime_2_or_more q).</code><br /></span><span data-subgoals="((&quot;forall _ : eq q (S (S O)), lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-5" onmouseover="hoverTactic(&quot;7-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq q (S (S O)), lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-6" onmouseover="hoverTactic(&quot;7-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'2.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;H'2 : eq q (S (S O))&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-7" onmouseover="hoverTactic(&quot;7-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">absurd (p = q).</code><br /></span><span data-subgoals="((&quot;not (eq p q)&quot;, (&quot;H'2 : eq q (S (S O))&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-8" onmouseover="hoverTactic(&quot;7-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;eq p q&quot;, (&quot;H'2 : eq q (S (S O))&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) q, lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-9" onmouseover="hoverTactic(&quot;7-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;eq p q&quot;, (&quot;H'2 : eq q (S (S O))&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) q, lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-10" onmouseover="hoverTactic(&quot;7-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite H'2.</code><br /></span><span data-subgoals="((&quot;eq p (S (S O))&quot;, (&quot;H'2 : eq q (S (S O))&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) q, lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-11" onmouseover="hoverTactic(&quot;7-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : lt (S (S O)) q, lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-12" onmouseover="hoverTactic(&quot;7-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : lt (S (S O)) q, lt (S O) pq&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-13" onmouseover="hoverTactic(&quot;7-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'2.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-14" onmouseover="hoverTactic(&quot;7-14&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_le_trans with (m := q - 1).</code><br /></span><span data-subgoals="((&quot;lt (S O) (Init.Nat.sub q (S O))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-15" onmouseover="hoverTactic(&quot;7-15&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S O) (Init.Nat.sub q (S O))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-16" onmouseover="hoverTactic(&quot;7-16&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_S_n.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-17" onmouseover="hoverTactic(&quot;7-17&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-18" onmouseover="hoverTactic(&quot;7-18&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-19" onmouseover="hoverTactic(&quot;7-19&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">replace (S (q - 1)) with (1 + (q - 1)).</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (Init.Nat.add (S O) (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-20" onmouseover="hoverTactic(&quot;7-20&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- (le_plus_minus 1 q).</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-21" onmouseover="hoverTactic(&quot;7-21&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-22" onmouseover="hoverTactic(&quot;7-22&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-23" onmouseover="hoverTactic(&quot;7-23&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply le_trans with (m := 2).</code><br /></span><span data-subgoals="((&quot;le (S O) (S (S O))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-24" onmouseover="hoverTactic(&quot;7-24&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S (S O)) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-25" onmouseover="hoverTactic(&quot;7-25&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S (S O)) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-26" onmouseover="hoverTactic(&quot;7-26&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_le_weak.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) q&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-27" onmouseover="hoverTactic(&quot;7-27&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add (S O) (Init.Nat.sub q (S O)))
  (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (Init.Nat.sub q (S O)) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-28" onmouseover="hoverTactic(&quot;7-28&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;eq (S (Init.Nat.sub q (S O))) (S (Init.Nat.sub q (S O)))&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (Init.Nat.sub q (S O)) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-29" onmouseover="hoverTactic(&quot;7-29&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (Init.Nat.sub q (S O)) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime q&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-30" onmouseover="hoverTactic(&quot;7-30&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (Init.Nat.sub q (S O)) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime q&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-31" onmouseover="hoverTactic(&quot;7-31&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_le.</code><br /></span><span data-subgoals="((&quot;not (eq pq O)&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime q&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-32" onmouseover="hoverTactic(&quot;7-32&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub q (S O)) pq&quot;, (&quot;H'2 : lt (S (S O)) q&quot;,&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime q&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-33" onmouseover="hoverTactic(&quot;7-33&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;prime q&quot;, (&quot;H'1 : eq p (S (S O))&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-34" onmouseover="hoverTactic(&quot;7-34&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-35" onmouseover="hoverTactic(&quot;7-35&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : lt (S (S O)) p, lt (S O) pq&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-36" onmouseover="hoverTactic(&quot;7-36&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-37" onmouseover="hoverTactic(&quot;7-37&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_le_trans with (m := p - 1).</code><br /></span><span data-subgoals="((&quot;lt (S O) (Init.Nat.sub p (S O))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-38" onmouseover="hoverTactic(&quot;7-38&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S O) (Init.Nat.sub p (S O))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-39" onmouseover="hoverTactic(&quot;7-39&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_S_n.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-40" onmouseover="hoverTactic(&quot;7-40&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-41" onmouseover="hoverTactic(&quot;7-41&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-42" onmouseover="hoverTactic(&quot;7-42&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">replace (S (p - 1)) with (1 + (p - 1)).</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (Init.Nat.add (S O) (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-43" onmouseover="hoverTactic(&quot;7-43&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- (le_plus_minus 1 p).</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-44" onmouseover="hoverTactic(&quot;7-44&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-45" onmouseover="hoverTactic(&quot;7-45&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-46" onmouseover="hoverTactic(&quot;7-46&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply le_trans with (m := 2).</code><br /></span><span data-subgoals="((&quot;le (S O) (S (S O))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-47" onmouseover="hoverTactic(&quot;7-47&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S (S O)) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-48" onmouseover="hoverTactic(&quot;7-48&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S (S O)) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-49" onmouseover="hoverTactic(&quot;7-49&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_le_weak.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) p&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-50" onmouseover="hoverTactic(&quot;7-50&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.add (S O) (Init.Nat.sub p (S O)))
  (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (Init.Nat.sub p (S O)) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-51" onmouseover="hoverTactic(&quot;7-51&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;eq (S (Init.Nat.sub p (S O))) (S (Init.Nat.sub p (S O)))&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (Init.Nat.sub p (S O)) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-52" onmouseover="hoverTactic(&quot;7-52&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (Init.Nat.sub p (S O)) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-53" onmouseover="hoverTactic(&quot;7-53&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (Init.Nat.sub p (S O)) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-54" onmouseover="hoverTactic(&quot;7-54&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_le.</code><br /></span><span data-subgoals="((&quot;not (eq pq O)&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-55" onmouseover="hoverTactic(&quot;7-55&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub p (S O)) pq&quot;, (&quot;H'1 : lt (S (S O)) p&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-56" onmouseover="hoverTactic(&quot;7-56&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;prime p&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-7-57" onmouseover="hoverTactic(&quot;7-57&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="()" id="command-7-58" onmouseover="hoverTactic(&quot;7-58&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdrsa_correct&quot;)" onmouseout="unhoverLemma(&quot;RsaZdrsa_correct&quot;)"><code class="buttontext">Theorem rsa_correct :
 forall w : nat, congruent (p * q) (decrypt (encrypt w)) w.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (decrypt (encrypt w)) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-0" onmouseover="hoverTactic(&quot;9-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (decrypt (encrypt w)) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-1" onmouseover="hoverTactic(&quot;9-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (decrypt (encrypt w)) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-0" onmouseover="hoverTactic(&quot;9-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (decrypt (encrypt w)) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-1" onmouseover="hoverTactic(&quot;9-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">unfold decrypt  in |- *.</code><br /></span><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (power (encrypt w) d) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-2" onmouseover="hoverTactic(&quot;9-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">unfold encrypt in |- *.</code><br /></span><span data-subgoals="((&quot;forall w : nat, congruent (Init.Nat.mul p q) (power (power w e) d) w&quot;, (&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-3" onmouseover="hoverTactic(&quot;9-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power (power w e) d) w&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-4" onmouseover="hoverTactic(&quot;9-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_power.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-5" onmouseover="hoverTactic(&quot;9-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (1 &lt;= e * d).</code><br /></span><span data-subgoals="((&quot;forall _ : le (S O) (Init.Nat.mul e d),
congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-6" onmouseover="hoverTactic(&quot;9-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros leH.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-7" onmouseover="hoverTactic(&quot;9-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (divides pq (e * d - 1)).</code><br /></span><span data-subgoals="((&quot;forall _ : divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O)),
congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-8" onmouseover="hoverTactic(&quot;9-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;H : divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-9" onmouseover="hoverTactic(&quot;9-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear H.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-10" onmouseover="hoverTactic(&quot;9-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">cut (e * d = 1 + q0 * pq).</code><br /></span><span data-subgoals="((&quot;forall
  _ : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq)),
congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-11" onmouseover="hoverTactic(&quot;9-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros Eqed.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-12" onmouseover="hoverTactic(&quot;9-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply Chinese.</code><br /></span><span data-subgoals="((&quot;le w (power w (Init.Nat.mul e d))&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-13" onmouseover="hoverTactic(&quot;9-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;le w (power w (Init.Nat.mul e d))&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-14" onmouseover="hoverTactic(&quot;9-14&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite Eqed.</code><br /></span><span data-subgoals="((&quot;le w (power w (Init.Nat.add (S O) (Init.Nat.mul q0 pq)))&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-15" onmouseover="hoverTactic(&quot;9-15&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply power_le.</code><br /></span><span data-subgoals="((&quot;lt O (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-16" onmouseover="hoverTactic(&quot;9-16&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-17" onmouseover="hoverTactic(&quot;9-17&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-18" onmouseover="hoverTactic(&quot;9-18&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case (divides_dec p w).</code><br /></span><span data-subgoals="((&quot;forall _ : divides p w, congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-19" onmouseover="hoverTactic(&quot;9-19&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros divPpw.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-20" onmouseover="hoverTactic(&quot;9-20&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := 0).</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul e d)) O&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-21" onmouseover="hoverTactic(&quot;9-21&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_sym.</code><br /></span><span data-subgoals="((&quot;congruent p O (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-22" onmouseover="hoverTactic(&quot;9-22&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := power 0 (e * d)).</code><br /></span><span data-subgoals="((&quot;congruent p O (power O (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-23" onmouseover="hoverTactic(&quot;9-23&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_O.</code><br /></span><span data-subgoals="((&quot;congruent p O O&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-24" onmouseover="hoverTactic(&quot;9-24&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p O O&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-25" onmouseover="hoverTactic(&quot;9-25&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_ref.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (power O (Init.Nat.mul e d)) (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-26" onmouseover="hoverTactic(&quot;9-26&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p (power O (Init.Nat.mul e d)) (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-27" onmouseover="hoverTactic(&quot;9-27&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_pow.</code><br /></span><span data-subgoals="((&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-28" onmouseover="hoverTactic(&quot;9-28&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-29" onmouseover="hoverTactic(&quot;9-29&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_cong.</code><br /></span><span data-subgoals="((&quot;divides p w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-30" onmouseover="hoverTactic(&quot;9-30&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p O w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : not (divides p w),
congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-31" onmouseover="hoverTactic(&quot;9-31&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_cong.</code><br /></span><span data-subgoals="((&quot;divides p w&quot;, (&quot;divPpw : divides p w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : not (divides p w),
congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-32" onmouseover="hoverTactic(&quot;9-32&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : not (divides p w),
congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-33" onmouseover="hoverTactic(&quot;9-33&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros divPpw.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul e d)) w&quot;, (&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-34" onmouseover="hoverTactic(&quot;9-34&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite Eqed.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.add (S O) (Init.Nat.mul q0 pq))) w&quot;, (&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-35" onmouseover="hoverTactic(&quot;9-35&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;congruent p (Init.Nat.mul w (power w (Init.Nat.mul q0 pq))) w&quot;, (&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-36" onmouseover="hoverTactic(&quot;9-36&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear pq_div_p.</code><br /></span><span data-subgoals="((&quot;congruent p (Init.Nat.mul w (power w (Init.Nat.mul q0 pq))) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-37" onmouseover="hoverTactic(&quot;9-37&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite mult_comm.</code><br /></span><span data-subgoals="((&quot;congruent p (Nat.mul (power w (Init.Nat.mul q0 pq)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-38" onmouseover="hoverTactic(&quot;9-38&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := power 1 (q1 * q0) * w).</code><br /></span><span data-subgoals="((&quot;congruent p (Nat.mul (power w (Init.Nat.mul q0 pq)) w)
  (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-39" onmouseover="hoverTactic(&quot;9-39&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_times.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul q0 pq))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-40" onmouseover="hoverTactic(&quot;9-40&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul q0 pq))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-41" onmouseover="hoverTactic(&quot;9-41&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite mult_comm.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Nat.mul pq q0))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-42" onmouseover="hoverTactic(&quot;9-42&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">repeat rewrite &lt;- power_power.</code><br /></span><span data-subgoals="((&quot;congruent p (power (power w pq) q0) (power (power (S O) q1) q0)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-43" onmouseover="hoverTactic(&quot;9-43&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_pow.</code><br /></span><span data-subgoals="((&quot;congruent p (power w pq) (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-44" onmouseover="hoverTactic(&quot;9-44&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite H.</code><br /></span><span data-subgoals="((&quot;congruent p (power w (Init.Nat.mul q1 (Init.Nat.sub p (S O))))
  (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-45" onmouseover="hoverTactic(&quot;9-45&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">repeat rewrite &lt;- power_power.</code><br /></span><span data-subgoals="((&quot;congruent p (power (power w q1) (Init.Nat.sub p (S O)))
  (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-46" onmouseover="hoverTactic(&quot;9-46&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_SO.</code><br /></span><span data-subgoals="((&quot;congruent p (power (power w q1) (Init.Nat.sub p (S O))) (S O)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-47" onmouseover="hoverTactic(&quot;9-47&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply Fermat.</code><br /></span><span data-subgoals="((&quot;prime p&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-48" onmouseover="hoverTactic(&quot;9-48&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides p (power w q1))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-49" onmouseover="hoverTactic(&quot;9-49&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides p (power w q1))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-50" onmouseover="hoverTactic(&quot;9-50&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">red in |- *.</code><br /></span><span data-subgoals="((&quot;forall _ : divides p (power w q1), False&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-51" onmouseover="hoverTactic(&quot;9-51&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H' : divides p (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-52" onmouseover="hoverTactic(&quot;9-52&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case divPpw.</code><br /></span><span data-subgoals="((&quot;divides p w&quot;, (&quot;H' : divides p (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-53" onmouseover="hoverTactic(&quot;9-53&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply div_power_prime with (n := q1).</code><br /></span><span data-subgoals="((&quot;prime p&quot;, (&quot;H' : divides p (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-54" onmouseover="hoverTactic(&quot;9-54&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides p (power w q1)&quot;, (&quot;H' : divides p (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-55" onmouseover="hoverTactic(&quot;9-55&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-56" onmouseover="hoverTactic(&quot;9-56&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_SO.</code><br /></span><span data-subgoals="((&quot;congruent p (Init.Nat.mul (S O) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-57" onmouseover="hoverTactic(&quot;9-57&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;congruent p (Init.Nat.add w O) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-58" onmouseover="hoverTactic(&quot;9-58&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- plus_n_O.</code><br /></span><span data-subgoals="((&quot;congruent p w w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-59" onmouseover="hoverTactic(&quot;9-59&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent p w w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub p (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides p w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-60" onmouseover="hoverTactic(&quot;9-60&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_ref.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-61" onmouseover="hoverTactic(&quot;9-61&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-62" onmouseover="hoverTactic(&quot;9-62&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case (divides_dec q w).</code><br /></span><span data-subgoals="((&quot;forall _ : divides q w, congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-63" onmouseover="hoverTactic(&quot;9-63&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros divPpw.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-64" onmouseover="hoverTactic(&quot;9-64&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := 0).</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul e d)) O&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-65" onmouseover="hoverTactic(&quot;9-65&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_sym.</code><br /></span><span data-subgoals="((&quot;congruent q O (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-66" onmouseover="hoverTactic(&quot;9-66&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := power 0 (e * d)).</code><br /></span><span data-subgoals="((&quot;congruent q O (power O (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-67" onmouseover="hoverTactic(&quot;9-67&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_O.</code><br /></span><span data-subgoals="((&quot;congruent q O O&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-68" onmouseover="hoverTactic(&quot;9-68&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q O O&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-69" onmouseover="hoverTactic(&quot;9-69&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_ref.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (power O (Init.Nat.mul e d)) (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-70" onmouseover="hoverTactic(&quot;9-70&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q (power O (Init.Nat.mul e d)) (power w (Init.Nat.mul e d))&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-71" onmouseover="hoverTactic(&quot;9-71&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_pow.</code><br /></span><span data-subgoals="((&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-72" onmouseover="hoverTactic(&quot;9-72&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-73" onmouseover="hoverTactic(&quot;9-73&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_cong.</code><br /></span><span data-subgoals="((&quot;divides q w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-74" onmouseover="hoverTactic(&quot;9-74&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q O w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : not (divides q w),
congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-75" onmouseover="hoverTactic(&quot;9-75&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply divides_cong.</code><br /></span><span data-subgoals="((&quot;divides q w&quot;, (&quot;divPpw : divides q w&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : not (divides q w),
congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-76" onmouseover="hoverTactic(&quot;9-76&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : not (divides q w),
congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-77" onmouseover="hoverTactic(&quot;9-77&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros divPpw.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul e d)) w&quot;, (&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-78" onmouseover="hoverTactic(&quot;9-78&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite Eqed.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.add (S O) (Init.Nat.mul q0 pq))) w&quot;, (&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-79" onmouseover="hoverTactic(&quot;9-79&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;congruent q (Init.Nat.mul w (power w (Init.Nat.mul q0 pq))) w&quot;, (&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-80" onmouseover="hoverTactic(&quot;9-80&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion_clear pq_div_q.</code><br /></span><span data-subgoals="((&quot;congruent q (Init.Nat.mul w (power w (Init.Nat.mul q0 pq))) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-81" onmouseover="hoverTactic(&quot;9-81&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite mult_comm.</code><br /></span><span data-subgoals="((&quot;congruent q (Nat.mul (power w (Init.Nat.mul q0 pq)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-82" onmouseover="hoverTactic(&quot;9-82&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_trans with (b := power 1 (q1 * q0) * w).</code><br /></span><span data-subgoals="((&quot;congruent q (Nat.mul (power w (Init.Nat.mul q0 pq)) w)
  (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-83" onmouseover="hoverTactic(&quot;9-83&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_times.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul q0 pq))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-84" onmouseover="hoverTactic(&quot;9-84&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul q0 pq))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-85" onmouseover="hoverTactic(&quot;9-85&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite mult_comm.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Nat.mul pq q0))
  (power (S O) (Init.Nat.mul q1 q0))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-86" onmouseover="hoverTactic(&quot;9-86&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">repeat rewrite &lt;- power_power.</code><br /></span><span data-subgoals="((&quot;congruent q (power (power w pq) q0) (power (power (S O) q1) q0)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-87" onmouseover="hoverTactic(&quot;9-87&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_pow.</code><br /></span><span data-subgoals="((&quot;congruent q (power w pq) (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-88" onmouseover="hoverTactic(&quot;9-88&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite H.</code><br /></span><span data-subgoals="((&quot;congruent q (power w (Init.Nat.mul q1 (Init.Nat.sub q (S O))))
  (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-89" onmouseover="hoverTactic(&quot;9-89&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">repeat rewrite &lt;- power_power.</code><br /></span><span data-subgoals="((&quot;congruent q (power (power w q1) (Init.Nat.sub q (S O)))
  (power (S O) q1)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-90" onmouseover="hoverTactic(&quot;9-90&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_SO.</code><br /></span><span data-subgoals="((&quot;congruent q (power (power w q1) (Init.Nat.sub q (S O))) (S O)&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-91" onmouseover="hoverTactic(&quot;9-91&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply Fermat.</code><br /></span><span data-subgoals="((&quot;prime q&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-92" onmouseover="hoverTactic(&quot;9-92&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides q (power w q1))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-93" onmouseover="hoverTactic(&quot;9-93&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (divides q (power w q1))&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-94" onmouseover="hoverTactic(&quot;9-94&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">red in |- *.</code><br /></span><span data-subgoals="((&quot;forall _ : divides q (power w q1), False&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-95" onmouseover="hoverTactic(&quot;9-95&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H' : divides q (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-96" onmouseover="hoverTactic(&quot;9-96&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case divPpw.</code><br /></span><span data-subgoals="((&quot;divides q w&quot;, (&quot;H' : divides q (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-97" onmouseover="hoverTactic(&quot;9-97&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply div_power_prime with (n := q1).</code><br /></span><span data-subgoals="((&quot;prime q&quot;, (&quot;H' : divides q (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-98" onmouseover="hoverTactic(&quot;9-98&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides q (power w q1)&quot;, (&quot;H' : divides q (power w q1)&quot;,&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-99" onmouseover="hoverTactic(&quot;9-99&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q (Init.Nat.mul (power (S O) (Init.Nat.mul q1 q0)) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-100" onmouseover="hoverTactic(&quot;9-100&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite power_SO.</code><br /></span><span data-subgoals="((&quot;congruent q (Init.Nat.mul (S O) w) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-101" onmouseover="hoverTactic(&quot;9-101&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;congruent q (Init.Nat.add w O) w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-102" onmouseover="hoverTactic(&quot;9-102&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- plus_n_O.</code><br /></span><span data-subgoals="((&quot;congruent q w w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-103" onmouseover="hoverTactic(&quot;9-103&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent q w w&quot;, (&quot;H : eq pq (Init.Nat.mul q1 (Init.Nat.sub q (S O)))&quot;,&quot;q1 : nat&quot;,&quot;divPpw : not (divides q w)&quot;,&quot;Eqed : eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;,&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-104" onmouseover="hoverTactic(&quot;9-104&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_ref.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-105" onmouseover="hoverTactic(&quot;9-105&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul e d) (Init.Nat.add (S O) (Init.Nat.mul q0 pq))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-106" onmouseover="hoverTactic(&quot;9-106&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- H0.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul e d)
  (Init.Nat.add (S O) (Init.Nat.sub (Init.Nat.mul e d) (S O)))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-107" onmouseover="hoverTactic(&quot;9-107&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul e d)
  (Init.Nat.add (S O) (Init.Nat.sub (Init.Nat.mul e d) (S O)))&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-108" onmouseover="hoverTactic(&quot;9-108&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">rewrite &lt;- le_plus_minus.</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul e d) (Init.Nat.mul e d)&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-109" onmouseover="hoverTactic(&quot;9-109&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;H0 : eq (Init.Nat.sub (Init.Nat.mul e d) (S O)) (Init.Nat.mul q0 pq)&quot;,&quot;q0 : nat&quot;,&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-110" onmouseover="hoverTactic(&quot;9-110&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-111" onmouseover="hoverTactic(&quot;9-111&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;divides pq (Init.Nat.sub (Init.Nat.mul e d) (S O))&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-112" onmouseover="hoverTactic(&quot;9-112&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong_divides.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-113" onmouseover="hoverTactic(&quot;9-113&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;congruent pq (Init.Nat.mul e d) (S O)&quot;, (&quot;leH : le (S O) (Init.Nat.mul e d)&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-114" onmouseover="hoverTactic(&quot;9-114&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-115" onmouseover="hoverTactic(&quot;9-115&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">idtac.</code><br /></span><span data-subgoals="((&quot;le (S O) (Init.Nat.mul e d)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-116" onmouseover="hoverTactic(&quot;9-116&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply cong1_le with pq.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent pq (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-117" onmouseover="hoverTactic(&quot;9-117&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S O) pq&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent pq (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-118" onmouseover="hoverTactic(&quot;9-118&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply phi_gt_SO.</code><br /></span><span data-subgoals="((&quot;congruent pq (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent pq (Init.Nat.mul e d) (S O)&quot;,&quot;pq_div_q : divides (Init.Nat.sub q (S O)) pq&quot;,&quot;pq_div_p : divides (Init.Nat.sub p (S O)) pq&quot;,&quot;pqnot_zero : not (eq pq O)&quot;,&quot;e,d,pq : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-9-119" onmouseover="hoverTactic(&quot;9-119&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="()" id="command-9-120" onmouseover="hoverTactic(&quot;9-120&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div><code class="plaincommand">End RSA.</code><br /><code class="plaincommand">Section RSAI.</code><br /><code class="plaincommand">Variable p q : nat.</code><br /><code class="plaincommand">Variable prime_p : prime p.</code><br /><code class="plaincommand">Variable prime_q : prime q.</code><br /><code class="plaincommand">Variable neq_pq : p &lt;&gt; q.</code><br /><code class="plaincommand">Variable e d : nat.</code><br /><code class="plaincommand">Variable ed_inv : congruent ((p - 1) * (q - 1)) (e * d) 1.</code><br /><button class="collapsible okay" onmouseover="hoverLemma(&quot;RsaZdrsa_correct'&quot;)" onmouseout="unhoverLemma(&quot;RsaZdrsa_correct'&quot;)"><code class="buttontext">Theorem rsa_correct' :
 forall w : nat, congruent (p * q) (decrypt d (encrypt e w)) w.</code></button><div class="region"><div class="predicted"><span data-subgoals="((&quot;forall w : nat,
congruent (Init.Nat.mul p q) (decrypt d (encrypt e w)) w&quot;, (&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-0" onmouseover="hoverTactic(&quot;11-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Proof.</code><br /></span><span data-subgoals="((&quot;forall w : nat,
congruent (Init.Nat.mul p q) (decrypt d (encrypt e w)) w&quot;, (&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-1" onmouseover="hoverTactic(&quot;11-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Admitted.</code><br /></span></div><div class="original"><span data-subgoals="((&quot;forall w : nat,
congruent (Init.Nat.mul p q) (decrypt d (encrypt e w)) w&quot;, (&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-0" onmouseover="hoverTactic(&quot;11-0&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros w.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul p q) (decrypt d (encrypt e w)) w&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-1" onmouseover="hoverTactic(&quot;11-1&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply rsa_correct with (pq := (p - 1) * (q - 1)).</code><br /></span><span data-subgoals="((&quot;prime p&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;prime q&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-2" onmouseover="hoverTactic(&quot;11-2&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;prime q&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;not (eq p q)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-3" onmouseover="hoverTactic(&quot;11-3&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (eq p q)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;not (eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-4" onmouseover="hoverTactic(&quot;11-4&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-5" onmouseover="hoverTactic(&quot;11-5&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-6" onmouseover="hoverTactic(&quot;11-6&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">red in |- *.</code><br /></span><span data-subgoals="((&quot;forall
  _ : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O,
False&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-7" onmouseover="hoverTactic(&quot;11-7&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-8" onmouseover="hoverTactic(&quot;11-8&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case (mult_eqO _ _ H').</code><br /></span><span data-subgoals="((&quot;forall _ : eq (Init.Nat.sub p (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-9" onmouseover="hoverTactic(&quot;11-9&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">generalize (prime_2_or_more p prime_p).</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq p (S (S O))) (lt (S (S O)) p))
  (_ : eq (Init.Nat.sub p (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-10" onmouseover="hoverTactic(&quot;11-10&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case p.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O))
  (_ : eq (Init.Nat.sub O (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-11" onmouseover="hoverTactic(&quot;11-11&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O)) (_ : eq O O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-12" onmouseover="hoverTactic(&quot;11-12&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O)) (_ : eq O O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-13" onmouseover="hoverTactic(&quot;11-13&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'0.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-14" onmouseover="hoverTactic(&quot;11-14&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim H'0.</code><br /></span><span data-subgoals="((&quot;forall (_ : eq O (S (S O))) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-15" onmouseover="hoverTactic(&quot;11-15&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq O (S (S O))&quot;,&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-16" onmouseover="hoverTactic(&quot;11-16&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (_ : lt (S (S O)) O) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-17" onmouseover="hoverTactic(&quot;11-17&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) O&quot;,&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-18" onmouseover="hoverTactic(&quot;11-18&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-19" onmouseover="hoverTactic(&quot;11-19&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-20" onmouseover="hoverTactic(&quot;11-20&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-21" onmouseover="hoverTactic(&quot;11-21&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-22" onmouseover="hoverTactic(&quot;11-22&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case n.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O)))
  (_ : eq (Init.Nat.sub O O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-23" onmouseover="hoverTactic(&quot;11-23&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))) (_ : eq O O),
False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-24" onmouseover="hoverTactic(&quot;11-24&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))) (_ : eq O O),
False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-25" onmouseover="hoverTactic(&quot;11-25&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'0.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-26" onmouseover="hoverTactic(&quot;11-26&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim H'0.</code><br /></span><span data-subgoals="((&quot;forall (_ : eq (S O) (S (S O))) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-27" onmouseover="hoverTactic(&quot;11-27&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq (S O) (S (S O))&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-28" onmouseover="hoverTactic(&quot;11-28&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq (S O) (S (S O))&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-29" onmouseover="hoverTactic(&quot;11-29&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (_ : lt (S (S O)) (S O)) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-30" onmouseover="hoverTactic(&quot;11-30&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-31" onmouseover="hoverTactic(&quot;11-31&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-32" onmouseover="hoverTactic(&quot;11-32&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">absurd (2 &lt; 1).</code><br /></span><span data-subgoals="((&quot;not (lt (S (S O)) (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-33" onmouseover="hoverTactic(&quot;11-33&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (lt (S (S O)) (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-34" onmouseover="hoverTactic(&quot;11-34&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_asym.</code><br /></span><span data-subgoals="((&quot;lt (S O) (S (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-35" onmouseover="hoverTactic(&quot;11-35&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S O)&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-36" onmouseover="hoverTactic(&quot;11-36&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-37" onmouseover="hoverTactic(&quot;11-37&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (S n) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-38" onmouseover="hoverTactic(&quot;11-38&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (S n) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-39" onmouseover="hoverTactic(&quot;11-39&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n0 H'0 H'1.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H'1 : eq (S n0) O&quot;,&quot;H'0 : or (eq (S (S n0)) (S (S O))) (lt (S (S O)) (S (S n0)))&quot;,&quot;n,n0 : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-40" onmouseover="hoverTactic(&quot;11-40&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq (Init.Nat.sub q (S O)) O, False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-41" onmouseover="hoverTactic(&quot;11-41&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">generalize (prime_2_or_more q prime_q).</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq q (S (S O))) (lt (S (S O)) q))
  (_ : eq (Init.Nat.sub q (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-42" onmouseover="hoverTactic(&quot;11-42&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case q.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O))
  (_ : eq (Init.Nat.sub O (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-43" onmouseover="hoverTactic(&quot;11-43&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O)) (_ : eq O O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-44" onmouseover="hoverTactic(&quot;11-44&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq O (S (S O))) (lt (S (S O)) O)) (_ : eq O O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-45" onmouseover="hoverTactic(&quot;11-45&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'0.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-46" onmouseover="hoverTactic(&quot;11-46&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim H'0.</code><br /></span><span data-subgoals="((&quot;forall (_ : eq O (S (S O))) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-47" onmouseover="hoverTactic(&quot;11-47&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq O (S (S O))&quot;,&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-48" onmouseover="hoverTactic(&quot;11-48&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (_ : lt (S (S O)) O) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-49" onmouseover="hoverTactic(&quot;11-49&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) O&quot;,&quot;H'0 : or (eq O (S (S O))) (lt (S (S O)) O)&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-50" onmouseover="hoverTactic(&quot;11-50&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub (S n) (S O)) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-51" onmouseover="hoverTactic(&quot;11-51&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-52" onmouseover="hoverTactic(&quot;11-52&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat) (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-53" onmouseover="hoverTactic(&quot;11-53&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S n) (S (S O))) (lt (S (S O)) (S n)))
  (_ : eq (Init.Nat.sub n O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-54" onmouseover="hoverTactic(&quot;11-54&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">case n.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O)))
  (_ : eq (Init.Nat.sub O O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-55" onmouseover="hoverTactic(&quot;11-55&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))) (_ : eq O O),
False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-56" onmouseover="hoverTactic(&quot;11-56&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (_ : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))) (_ : eq O O),
False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-57" onmouseover="hoverTactic(&quot;11-57&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'0.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-58" onmouseover="hoverTactic(&quot;11-58&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">elim H'0.</code><br /></span><span data-subgoals="((&quot;forall (_ : eq (S O) (S (S O))) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-59" onmouseover="hoverTactic(&quot;11-59&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq (S O) (S (S O))&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-60" onmouseover="hoverTactic(&quot;11-60&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : eq (S O) (S (S O))&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-61" onmouseover="hoverTactic(&quot;11-61&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;forall (_ : lt (S (S O)) (S O)) (_ : eq O O), False&quot;, (&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-62" onmouseover="hoverTactic(&quot;11-62&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros H'1.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-63" onmouseover="hoverTactic(&quot;11-63&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall _ : eq O O, False&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-64" onmouseover="hoverTactic(&quot;11-64&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">absurd (2 &lt; 1).</code><br /></span><span data-subgoals="((&quot;not (lt (S (S O)) (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-65" onmouseover="hoverTactic(&quot;11-65&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;not (lt (S (S O)) (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-66" onmouseover="hoverTactic(&quot;11-66&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply lt_asym.</code><br /></span><span data-subgoals="((&quot;lt (S O) (S (S O))&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-67" onmouseover="hoverTactic(&quot;11-67&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;lt (S (S O)) (S O)&quot;, (&quot;H'1 : lt (S (S O)) (S O)&quot;,&quot;H'0 : or (eq (S O) (S (S O))) (lt (S (S O)) (S O))&quot;,&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-68" onmouseover="hoverTactic(&quot;11-68&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (Init.Nat.sub (S n) O) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-69" onmouseover="hoverTactic(&quot;11-69&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">simpl in |- *.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (S n) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-70" onmouseover="hoverTactic(&quot;11-70&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;forall (n : nat)
  (_ : or (eq (S (S n)) (S (S O))) (lt (S (S O)) (S (S n))))
  (_ : eq (S n) O), False&quot;, (&quot;n : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-71" onmouseover="hoverTactic(&quot;11-71&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">intros n0 H'0 H'1.</code><br /></span><span data-subgoals="((&quot;False&quot;, (&quot;H'1 : eq (S n0) O&quot;,&quot;H'0 : or (eq (S (S n0)) (S (S O))) (lt (S (S O)) (S (S n0)))&quot;,&quot;n,n0 : nat&quot;,&quot;H' : eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O))) O&quot;,&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-72" onmouseover="hoverTactic(&quot;11-72&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">inversion H'1.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub q (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-73" onmouseover="hoverTactic(&quot;11-73&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub p (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub q (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-74" onmouseover="hoverTactic(&quot;11-74&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply dividesDef with (q := q - 1).</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul (Init.Nat.sub q (S O)) (Init.Nat.sub p (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;divides (Init.Nat.sub q (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-75" onmouseover="hoverTactic(&quot;11-75&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub q (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-76" onmouseover="hoverTactic(&quot;11-76&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="((&quot;divides (Init.Nat.sub q (S O))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-77" onmouseover="hoverTactic(&quot;11-77&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">apply dividesDef with (q := p - 1).</code><br /></span><span data-subgoals="((&quot;eq (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)),(&quot;congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-78" onmouseover="hoverTactic(&quot;11-78&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto with arith.</code><br /></span><span data-subgoals="((&quot;congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;, (&quot;w : nat&quot;,&quot;ed_inv : congruent (Init.Nat.mul (Init.Nat.sub p (S O)) (Init.Nat.sub q (S O)))
  (Init.Nat.mul e d) (S O)&quot;,&quot;e,d : nat&quot;,&quot;neq_pq : not (eq p q)&quot;,&quot;prime_q : prime q&quot;,&quot;prime_p : prime p&quot;,&quot;p,q : nat&quot;)))" id="command-11-79" onmouseover="hoverTactic(&quot;11-79&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">auto.</code><br /></span><span data-subgoals="()" id="command-11-80" onmouseover="hoverTactic(&quot;11-80&quot;)" onmouseout="unhoverTactic()"><code class="plaincommand">Qed.</code><br /></span></div></div></pre></body></html>